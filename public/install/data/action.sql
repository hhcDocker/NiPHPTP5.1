DROP TABLE IF EXISTS `np_action`;
CREATE TABLE IF NOT EXISTS `np_action` (
  `id` smallint(6) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(30) NOT NULL DEFAULT '' COMMENT '行为唯一标识',
  `title` varchar(80) NOT NULL DEFAULT '' COMMENT '行为说明',
  `remark` varchar(140) NOT NULL DEFAULT '' COMMENT '描述',
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='行为表';
INSERT INTO `np_action` (`id`, `name`, `title`, `remark`) VALUES
(1, 'admin_login', '管理员登录', ''),
(2, 'admin_logout', '管理员退出', ''),
(3, 'admin_added', '添加管理员', ''),
(4, 'admin_editor', '编辑管理员', ''),
(5, 'admin_delete', '删除管理员', ''),
(6, 'config_editor', '修改设置', ''),
(7, 'role_added', '添加管理组', ''),
(8, 'role_editor', '编辑管理组', ''),
(9, 'role_remove', '删除管理组', ''),
(10, 'user_added', '添加管理员', ''),
(11, 'user_editor', '编辑管理员', ''),
(12, 'user_remove', '删除管理员', ''),
(13, 'level_added', '添加会员等级(组)', ''),
(14, 'level_editor', '编辑会员等级(组)', ''),
(15, 'level_remove', '删除会员等级(组)', ''),
(16, 'member_added', '添加会员', ''),
(17, 'member_editor', '编辑会员', ''),
(18, 'member_remove', '删除会员', ''),
(19, 'node_added', '添加节点', ''),
(20, 'node_editor', '编辑节点', ''),
(21, 'node_remove', '删除节点', ''),
(22, 'node_sort', '节点排序', ''),
(23, 'model_sort', '模型排序', ''),
(24, 'model_added', '添加模型', ''),
(25, 'model_editor', '编辑模型', ''),
(26, 'model_remove', '删除模型', ''),
(27, 'category_sort', '栏目排序', ''),
(28, 'category_added', '添加栏目', ''),
(29, 'category_editor', '编辑栏目', ''),
(30, 'category_remove', '删除栏目', ''),
(31, 'fields_added', '添加自定义字段', ''),
(32, 'fields_editor', '编辑自定义字段', ''),
(33, 'fields_remove', '删除自定义字段', ''),
(34, 'databack_back', '备份数据库', ''),
(35, 'databack_down', '下载备份', ''),
(36, 'databack_remove', '删除备份文件', ''),
(37, 'databack_optimize', '优化数据库表', ''),
(38, 'databack_reduction', '还原数据库', ''),
(39, 'wechat_config_editor', '修改微信配置', ''),
(40, 'wechat_keyword_added', '添加微信回复', ''),
(41, 'wechat_keyword_editor', '编辑微信回复', ''),
(42, 'wechat_keyword_remove', '删除微信回复', ''),
(43, 'wechat_keyword_auto', '编辑微信自动回复', ''),
(44, 'wechat_keyword_attention', '编辑微信关注回复', ''),
(45, 'banner_added', '添加幻灯片', ''),
(46, 'banner_image_added', '添加幻灯片图片', ''),
(47, 'banner_editor', '编辑幻灯片', ''),
(48, 'banner_image_editor', '编辑幻灯片图片', ''),
(49, 'banner_remove', '删除幻灯片', ''),
(50, 'banner_image_remove', '删除幻灯片图片', ''),
(51, 'ads_added', '添加广告', ''),
(52, 'ads_editor', '编辑广告', ''),
(53, 'ads_remove', '删除广告', ''),
(54, 'comment_editor', '编辑评论', ''),
(55, 'comment_remove', '删除评论', ''),
(56, 'type_added', '添加分类', ''),
(57, 'type_editor', '编辑分类', ''),
(58, 'type_remove', '删除分类', ''),
(59, 'content_sort', '内容排序', ''),
(60, 'content_added', '添加内容', ''),
(61, 'content_editor', '编辑内容', ''),
(62, 'content_recycle', '删除内容到回收站', ''),
(63, 'content_reduction', '还原内容', ''),
(64, 'content_remove', '删除内容', ''),
(65, 'theme_editor', '编辑模板', ''),
(66, 'upload_file', '上传文件', '');

DROP TABLE IF EXISTS `np_action_log`;
CREATE TABLE IF NOT EXISTS `np_action_log` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `action_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '行为ID',
  `user_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '执行用户ID',
  `action_ip` varchar(255) NOT NULL COMMENT '执行行为者IP',
  `model` varchar(50) NOT NULL DEFAULT '' COMMENT '触发行为的模型方法',
  `record_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '触发行为的数据ID',
  `remark` varchar(255) NOT NULL DEFAULT '' COMMENT '日志备注',
  `create_time` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '执行行为的时间',
  PRIMARY KEY (`id`),
  KEY `action_ip` (`action_ip`),
  KEY `action_id` (`action_id`),
  KEY `user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='行为日志表';